<UserControl
    x:Class="GymClient.Views.ChipView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:GymClient.Utils"
    xmlns:local="clr-namespace:GymClient.Views"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Background="{DynamicResource MaterialDesignPaper}">

    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </UserControl.Resources>

    <StackPanel Margin="10" VerticalAlignment="Top">

        <!--  Top Panel  -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  Search  -->
            <TextBox
                Grid.Column="0"
                VerticalContentAlignment="Center"
                materialDesign:HintAssist.Hint="Поиск"
                materialDesign:TextFieldAssist.HasClearButton="True"
                Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />

            <!--  Add  -->
            <Button
                Grid.Column="2"
                Margin="16,0,8,0"
                Padding="16,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                materialDesign:ButtonAssist.CornerRadius="20"
                Command="{Binding OpenAddChipViewCommand}"
                ToolTip="Добавить чип доступа">
                <materialDesign:PackIcon Kind="Add" />
            </Button>
        </Grid>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <StackPanel Orientation="Vertical">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!--  Active Chips  -->
                    <StackPanel
                        Grid.Row="0"
                        Margin="5,5,5,5"
                        Orientation="Vertical">
                        <TextBlock
                            Margin="0,0,0,4"
                            HorizontalAlignment="Center"
                            FontSize="22"
                            FontWeight="Bold"
                            Foreground="#03A9F4"
                            Text="Активные чипы доступа" />
                        <DataGrid
                            Grid.Row="1"
                            AutoGenerateColumns="False"
                            Background="{DynamicResource MaterialDesignPaper}"
                            BorderThickness="0"
                            CanUserAddRows="False"
                            CanUserDeleteRows="False"
                            CanUserReorderColumns="False"
                            CanUserResizeRows="True"
                            CanUserSortColumns="True"
                            Foreground="{DynamicResource MaterialDesignBody}"
                            IsReadOnly="True"
                            ItemsSource="{Binding ActiveChips}"
                            SelectedItem="{Binding SelectedChip}"
                            SelectionMode="Single"
                            SelectionUnit="FullRow"
                            Visibility="{Binding HasActiveData, Converter={StaticResource BoolToVisibilityConverter}}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Id}"
                                    Header="ID" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding MemberFullName}"
                                    Header="Клиент" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding ChipNumber}"
                                    Header="Номер чипа" />
                                <DataGridTemplateColumn Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                                <Button
                                                    Command="{Binding DataContext.OpenEditChipCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    ToolTip="Редактировать">
                                                    <materialDesign:PackIcon Kind="Pencil" />
                                                </Button>
                                                <Button
                                                    Command="{Binding DataContext.DeleteChipCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    ToolTip="Удалить">
                                                    <materialDesign:PackIcon Kind="Delete" />
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                            <DataGrid.CellStyle>
                                <Style BasedOn="{StaticResource MaterialDesignDataGridCell}" TargetType="DataGridCell">
                                    <Setter Property="BorderThickness" Value="0" />
                                    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                </Style>
                            </DataGrid.CellStyle>
                        </DataGrid>
                        <!--  No data  -->
                        <TextBlock
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="66"
                            FontWeight="SemiBold"
                            Foreground="Gray"
                            Text="Нет данных"
                            Visibility="{Binding HasActiveData, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}" />

                        <!--  Inactive Chips  -->
                        <TextBlock
                            Margin="0,40,0,4"
                            HorizontalAlignment="Center"
                            FontSize="22"
                            FontWeight="Bold"
                            Foreground="#03A9F4"
                            Text="Неактивные чипы доступа" />
                        <DataGrid
                            Grid.Row="1"
                            AutoGenerateColumns="False"
                            Background="{DynamicResource MaterialDesignPaper}"
                            BorderThickness="0"
                            CanUserAddRows="False"
                            CanUserDeleteRows="False"
                            CanUserReorderColumns="False"
                            CanUserResizeRows="True"
                            CanUserSortColumns="True"
                            Foreground="{DynamicResource MaterialDesignBody}"
                            IsReadOnly="True"
                            ItemsSource="{Binding InactiveChips}"
                            SelectedItem="{Binding SelectedChip}"
                            SelectionMode="Single"
                            SelectionUnit="FullRow"
                            Visibility="{Binding HasInactiveData, Converter={StaticResource BoolToVisibilityConverter}}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Id}"
                                    Header="ID" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding MemberFullName}"
                                    Header="Клиент" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding ChipNumber}"
                                    Header="Номер чипа" />
                                <DataGridTemplateColumn Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                                <Button
                                                    Command="{Binding DataContext.OpenEditChipCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    ToolTip="Редактировать">
                                                    <materialDesign:PackIcon Kind="Pencil" />
                                                </Button>
                                                <Button
                                                    Command="{Binding DataContext.DeleteChipCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    ToolTip="Удалить">
                                                    <materialDesign:PackIcon Kind="Delete" />
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                            <DataGrid.CellStyle>
                                <Style BasedOn="{StaticResource MaterialDesignDataGridCell}" TargetType="DataGridCell">
                                    <Setter Property="BorderThickness" Value="0" />
                                    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                </Style>
                            </DataGrid.CellStyle>
                        </DataGrid>
                        <!--  No data  -->
                        <TextBlock
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="66"
                            FontWeight="SemiBold"
                            Foreground="Gray"
                            Text="Нет данных"
                            Visibility="{Binding HasInactiveData, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Grid>
    </StackPanel>
</UserControl>
